# Запрос в поддержку Posiflora: интеграция бонусов и заказов

**Тема письма:** Запрос на интеграцию с Posiflora: бонусная система и ведение заказов (Telegram Mini App)

**Куда писать:**
- **Telegram:** [@Posiflora_bot](https://t.me/Posiflora_bot)
- **WhatsApp:** +7 (499) 348-20-95
- **Сайт:** [posiflora.com](https://posiflora.com)
- **Документация:** [posiflora.usedocs.com](https://posiflora.usedocs.com)

---

## Текст запроса

Здравствуйте!

Обращаемся от имени компании, которая использует Posiflora для учёта в цветочном магазине. Нам нужна интеграция с Posiflora для нашего **Telegram Mini App** — каталог и оформление заказов внутри Telegram.

Нужна интеграция по двум направлениям: **бонусная система** и **ведение заказов** — чтобы Mini App работал с учётной системой Posiflora.

---

### 1. Бонусная система

**Требуется:**

- **Получение баланса бонусов** — по телефону (или другому идентификатору клиента) для отображения в каталоге и при оформлении заказа.
- **Расчёт бонусов** — сколько начисляется на заказ и сколько можно списать.
- **Списание бонусов** — при оформлении заказа, если клиент выбрал оплату бонусами.
- **Начисление бонусов** — после подтверждения или закрытия заказа в Posiflora.

**Вопросы:**

1. Какие методы API используются для получения баланса бонусов клиента?
2. По какому полю идентифицируется клиент (телефон, email, ID в Posiflora)?
3. Какие методы нужны для расчёта начисления и списания бонусов?
4. Как провести списание/начисление при создании или изменении заказа?
5. Есть ли webhook или способ уведомлять нашу систему об изменении баланса?

---

### 2. Ведение заказов

**Требуется:**

- **Создание заказа в Posiflora** — при оформлении в Mini App.
- **Получение статуса заказа** — из Posiflora для отображения клиенту в Mini App.
- **Синхронизация статусов** — новые, подтверждённые, в сборке, передан в доставку, доставлен, отменён и т.п.

**Вопросы:**

1. Какие методы API используются для создания заказа? Минимальный набор: товары, суммы, доставка/самовывоз, адрес/точка, контакты, получатель.
2. Как получить статус заказа и историю изменений по ID заказа в Posiflora?
3. Есть ли webhook или push при смене статуса заказа?
4. Нужно ли передавать источник заказа (telegram_mini_app) и в каком формате?
5. Как связать нашего клиента (user_id в нашей системе, телефон) с клиентом/заказом в Posiflora?

---

### Технические пожелания

- **Формат:** REST API, JSON.
- **Аутентификация:** токен (Bearer), сессии через логин/пароль.
- **Документация:** описание методов для бонусов и заказов.

Готовы предоставить дополнительные данные по Mini App и форме заказа и обсудить детали интеграции.

С уважением,  
[Ваше имя]  
[Должность]  
[Контактный телефон]  
[Email]

---

## Дополнительная информация для поддержки

| Параметр | Значение |
|----------|----------|
| Интеграция | Только Telegram Mini App |
| Цель | Заказы и бонусы из Mini App в Posiflora |
| Дата запроса | 23.01.2026 |

---

## После ответа Posiflora

1. Изучить документацию API.
2. Реализовать в `backend/src/integrations/posiflora/`:
   - `orders.ts` — создание заказов, получение статусов.
   - `bonus.ts` — баланс, расчёт, списание/начисление.
3. Обновить `backend/src/api/controllers/orders.controller.ts` — создание заказа в Posiflora.
4. Обновить `backend/src/api/controllers/bonus.controller.ts` — работа с бонусами через Posiflora.
5. Заполнить в `.env`: `POSIFLORA_API_URL`, `POSIFLORA_USERNAME`, `POSIFLORA_PASSWORD`.
