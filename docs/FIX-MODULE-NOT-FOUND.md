# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ "Cannot find module '/app/src/database/migrate.ts'"

## –ü—Ä–æ–±–ª–µ–º–∞

–û—à–∏–±–∫–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ backend –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –≤ production:
```
Error [ERR_MODULE_NOT_FOUND]: Cannot find module '/app/src/database/migrate.ts' imported from /app/
```

## –ü—Ä–∏—á–∏–Ω–∞

–í production –æ–±—Ä–∞–∑–µ Docker –Ω–µ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `src/`, —Ç–æ–ª—å–∫–æ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥ –≤ `dist/`. –û—à–∏–±–∫–∞ –º–æ–∂–µ—Ç –≤–æ–∑–Ω–∏–∫–∞—Ç—å –µ—Å–ª–∏:
1. TypeScript –Ω–µ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–ª –≤—Å–µ —Ñ–∞–π–ª—ã
2. –ï—Å—Ç—å –ø—Ä–æ–±–ª–µ–º–∞ —Å –ø—É—Ç—è–º–∏ –∏–º–ø–æ—Ä—Ç–∞
3. –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### 1. –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑ —Å –æ—á–∏—Å—Ç–∫–æ–π –∫—ç—à–∞

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
cd /opt/TG_BOT_Chvetyk/TG_BOT_Chvetyk

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker compose down

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –±–µ–∑ –∫—ç—à–∞
docker compose build --no-cache backend

# –ó–∞–ø—É—Å—Ç–∏—Ç—å
docker compose up -d

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
docker compose logs backend
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Ñ–∞–π–ª—ã —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω—ã

```bash
# –í–æ–π—Ç–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker compose exec backend sh

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É dist
ls -la dist/
ls -la dist/database/

# –î–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ñ–∞–π–ª—ã:
# dist/index.js
# dist/database/migrate.js
# dist/database/connection.js
# –∏ —Ç.–¥.
```

### 3. –ï—Å–ª–∏ —Ñ–∞–π–ª—ã –Ω–µ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω—ã

```bash
# –í–æ–π—Ç–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä build stage (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
docker compose run --rm backend sh

# –í—Ä—É—á–Ω—É—é —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å
cd /app/backend
npm run build

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
ls -la dist/
```

### 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–º–∞–Ω–¥—É –∑–∞–ø—É—Å–∫–∞

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ Dockerfile –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞:
```dockerfile
CMD ["node", "dist/index.js"]
```

–ê –Ω–µ:
```dockerfile
CMD ["tsx", "src/index.ts"]  # ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –¥–ª—è production
```

### 5. –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ (–µ—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç)

```bash
# –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏ –æ–±—Ä–∞–∑—ã
docker compose down -v
docker rmi tg_bot_chvetyk-backend:latest 2>/dev/null || true

# –û—á–∏—Å—Ç–∏—Ç—å build –∫—ç—à
docker builder prune -f

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å —Å –Ω—É–ª—è
docker compose build backend
docker compose up -d

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
docker compose logs -f backend
```

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –æ–±—Ä–∞–∑–∞

```bash
# –°–æ–∑–¥–∞—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏–∑ –æ–±—Ä–∞–∑–∞
docker run --rm -it --entrypoint sh tg_bot_chvetyk-backend:latest

# –í –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É
ls -la /app/
ls -la /app/dist/
ls -la /app/dist/database/
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ —Å–±–æ—Ä–∫–∏

```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ —Å–±–æ—Ä–∫–∏ –æ–±—Ä–∞–∑–∞
docker compose build backend 2>&1 | tee build.log

# –ò—Å–∫–∞—Ç—å –æ—à–∏–±–∫–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
grep -i "error\|failed" build.log
```

## üìù –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

–í –ø–æ—Å–ª–µ–¥–Ω–µ–º –∫–æ–º–º–∏—Ç–µ –±—ã–ª–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã:
1. ‚úÖ –ó–∞–º–µ–Ω–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∏–º–ø–æ—Ä—Ç—ã –Ω–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –≤ `app.ts`
2. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã –ø—É—Ç–∏ –∫ –º–∏–≥—Ä–∞—Ü–∏—è–º (–¥–æ–±–∞–≤–ª–µ–Ω `/app/dist/database/migrations`)
3. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã –ø—É—Ç–∏ –∫ seed —Ñ–∞–π–ª–∞–º

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —ç—Ç–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏ –ø—Ä–æ–±–ª–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –∏—Å—á–µ–∑–Ω—É—Ç—å.

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

–ü–æ—Å–ª–µ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ:
1. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î:
   ```bash
   docker compose exec backend npm run migrate
   ```

2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å health check:
   ```bash
   curl http://localhost:3000/health
   ```

3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏:
   ```bash
   docker compose logs --tail=50 backend
   ```
